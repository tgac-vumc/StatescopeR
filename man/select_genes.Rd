% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/select_genes.R
\name{select_genes}
\alias{select_genes}
\title{Select genes using AutoGeneS}
\usage{
select_genes(data, fixed_n_features = NA)
}
\arguments{
\item{data}{SingleCellExperiment object to use for gene selection, should be
same as signature dataset}

\item{fixed_n_features}{integer number of genes to pick with autogenes,
default is NA which lets autogenes itself pick}
}
\value{
Vector of genes to use for deconvolution
}
\description{
\code{select_genes.R} select genes using AutoGeneS for deconvolution
}
\examples{
# Load data
data <- scRNAseq::SegerstolpePancreasData()

## subset to 100 genes for example
data <- data[1:100]
data$donor <- data$individual
data$label <- data$`cell type`
## remove NA cells
data <- data[, !is.na(data$label)]

# remove duplicates gene names
data <- data[!duplicated(rownames(data)), ]

# remove cells with less than 100 in total cohort
celltypes_to_remove <- names(table(data$label)[(table(data$label) < 100)])
data <- data[, !data$label \%in\% celltypes_to_remove]
data <- normalize_scRNAseq(data)
selected_genes <- select_genes(data)
}
