% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BLADE_deconvolution.R
\name{BLADE_deconvolution}
\alias{BLADE_deconvolution}
\title{Run BLADE deconvolution}
\usage{
BLADE_deconvolution(
  signature,
  bulk,
  genes,
  cores = 1L,
  Alpha = 1L,
  Alpha0 = 1000L,
  Kappa0 = 1L,
  sY = 1L,
  Nrep = 10L,
  Nrepfinal = 1000L
)
}
\arguments{
\item{signature}{SimpleList with mu and sigma, respectively mean gene
expression and mean-variance corrected variance per cell type}

\item{bulk}{mRNA to be deconvolved}

\item{genes}{subset of genes to be used for deconvolution}

\item{cores}{number of cores to use for paralellization}

\item{Alpha}{BLADE Hyperparameter}

\item{Alpha0}{BLADE Hyperparameter}

\item{Kappa0}{BLADE Hyperparameter}

\item{sY}{BLADE Hyperparameter}

\item{Nrep}{Number of BLADE initializations}

\item{Nrepfinal}{Number of maximum optimization iterations}
}
\value{
Statescope S4 object
}
\description{
\code{BLADE_deconvolution.R} Runs BLADE to estimate cell fractions from bulk
mRNA
}
\examples{
## Load data
data <- scRNAseq::SegerstolpePancreasData()

## subset to 100 genes for example
data <- data[1:100]
## Preprocess data
data$donor <- data$individual
data$label <- data$`cell type`

## remove NA cells
data <- data[, !is.na(data$label)]

## remove duplicates gene names
data <- data[!duplicated(rownames(data)), ]

## remove cells with less than 100 in total cohort
celltypes_to_remove <- names(table(data$label)[(table(data$label) < 100)])
data <- data[, !data$label \%in\% celltypes_to_remove]

data <- normalize_scRNAseq(data)

## Create and normalized pseudobulk from scRNAseq
pseudobulk <- generate_pseudobulk(data)

pseudobulk <- normalize_bulkRNAseq(pseudobulk)

## Measure true cell fractions from pseudobulk
true_fractions <- gather_true_fractions(data)

## Create signature from scRNAseq for deconvolution
signature <- create_signature(data)

## Select genes optimized for deconvolution
selected_genes <- select_genes(data)

## Perform Deconvolution with BLADE
Statescope <- BLADE_deconvolution(signature, pseudobulk, selected_genes, 1L)
fractions(Statescope)

}
