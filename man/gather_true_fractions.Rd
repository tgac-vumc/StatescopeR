% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gather_true_fractions.R
\name{gather_true_fractions}
\alias{gather_true_fractions}
\title{Gather true fractions}
\usage{
gather_true_fractions(data)
}
\arguments{
\item{data}{SingleCellExperiment object of which to gather fractions per sample}
}
\value{
DataFrame with fractions of all cell types per sample
}
\description{
\code{gather_true_fractions} Gathers true fractions of all cell types per sample from scRNAseq data
}
\examples{
## Load data
data <- scRNAseq::SegerstolpePancreasData()

## subset to 100 genes for example
data = data[1:100]
## Preprocess data
data$donor = data$individual
data$label = data$`cell type`

## remove NA cells
data = data[,!is.na(data$label)]

## remove duplicates gene names
data = data[!duplicated(rownames(data)),]

## remove cells with less than 100 in total cohort
celltypes_to_remove = names(table(data$label)[(table(data$label) <100)])
data = data[,!data$label \%in\% celltypes_to_remove]

true_fractions = gather_true_fractions(data)
}
